import{r as d}from"./validators-be8c4c00.js";import{r as y,ah as T,a1 as C,c as b,b as a,e as i,a2 as J,E as K,o as q,s as o,F as Z,A as Q,d as _,a3 as x,M as E,Z as M,C as W,D as X,ai as Y}from"./main-2c7b2f02.js";import{_ as ee}from"./AppSelect-a9004238.js";import{_ as ae}from"./AppAutocomplete-abc96fea.js";import{_ as le}from"./AppDateTimePicker-ab2852dd.js";import{_ as re}from"./AppTextField-973e7013.js";import{_ as te}from"./GuaranteeEdit-81618821.js";import{u as h}from"./useApi-0b8c4c7e.js";import{c as F}from"./createUrl-2823fee2.js";import{$ as ie}from"./api-4b583571.js";import{_ as ue}from"./_plugin-vue_export-helper-c27b6911.js";import{V as oe}from"./VForm-98c143a1.js";import{V as I}from"./VRow-ce7baa34.js";import{V as s}from"./VCol-e2ec769f.js";import{V as S}from"./VCard-d4db518d.js";import{V as j}from"./VCardText-57b803c4.js";import{V as U}from"./VSlider-2f1b8cfa.js";import{V as w}from"./VTextField-99f7b7bb.js";import"./VSelect-5697e1b0.js";import"./forwardRefs-6ea3df5c.js";import"./VList-4e9926c0.js";import"./VImg-58d13ec6.js";import"./VAvatar-f742314d.js";import"./VDivider-9163f14e.js";import"./VOverlay-e53a1db8.js";import"./VMenu-b79ba6e2.js";import"./filter-b1e72b65.js";import"./AppTextarea-393d383d.js";import"./index-9c720871.js";import"./useAbility-c621e872.js";const N=f=>(W("data-v-b7139163"),f=f(),X(),f),se=N(()=>_("div",{class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},[_("div",{class:"d-flex flex-column justify-center"},[_("h4",{class:"text-h4 font-weight-medium"}," Ajouter un nouveau PV "),_("span",null,"Procès verbal pour un nouveau crédit")])],-1)),de={class:"my-4 ma-sm-4"},ne={class:"mt-4 ma-sm-4"},me={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},pe=N(()=>_("div",{class:"d-flex flex-column justify-center"},null,-1)),_e={class:"d-flex gap-4 align-center flex-wrap"},fe={__name:"add",async setup(f){let p,v;const k=K(),e=y({committee_id:"CFNTG-044-13-12-23-01212",committee_date:"2024-02-02",caf_id:10,civility:"Mr",applicant_first_name:"Albert",applicant_last_name:"Einstein",account_number:"251012345678",activity:"Homme d'affaire",purpose_of_financing:"Achat de nouveau locaux",type_of_credit_id:1,amount:15e6,duration:6,periodicity:"mensual",due_amount:15e4,insurance_premium:15e3,administrative_fees_percentage:2.5,taf:10,tax_fee_interest_rate:17,guarantees:[{type_of_guarantee_id:1,expiration_date:"2030-03-03",value:15e5,comment:"RAS"}]}),A=()=>({committee_id:"",committee_date:"",caf_id:"",civility:"",applicant_first_name:"",applicant_last_name:"",account_number:"",activity:"",purpose_of_financing:"",type_of_credit_id:"",amount:"",duration:"",periodicity:"",due_amount:"",insurance_premium:"",administrative_fees_percentage:"",taf:"",tax_fee_interest_rate:""}),u=y(A()),D=[{value:"Mr",title:"Mr"},{value:"Mme",title:"Mme"},{value:"Mlle",title:"Mlle"}],P=[{value:"mensual",title:"Mensuelle"},{value:"quarterly",title:"Trimestrielle"},{value:"semi-annual",title:"Semestrielle"},{value:"annual",title:"Annuelle"},{value:"in-fine",title:"A la fin"}],{data:L}=([p,v]=T(()=>h(F("/type-of-credit",{query:{paginate:0}}))),p=await p,v(),p),$=C(()=>L.value.data),{data:R}=([p,v]=T(()=>h(F("/user",{query:{paginate:0,profile:"caf"}}))),p=await p,v(),p),G=C(()=>R.value.data),g=y(),B=()=>{var t;(t=g.value)==null||t.validate().then(async({valid:l})=>{if(l){const n=await ie("/verbal-trial",{method:"POST",body:{committee_id:e.value.committee_id,committee_date:e.value.committee_date,caf_id:e.value.caf_id,civility:e.value.civility,applicant_first_name:e.value.applicant_first_name,applicant_last_name:e.value.applicant_last_name,account_number:e.value.account_number,activity:e.value.activity,purpose_of_financing:e.value.purpose_of_financing,type_of_credit_id:e.value.type_of_credit_id,amount:e.value.amount,duration:e.value.duration,periodicity:e.value.periodicity,due_amount:e.value.due_amount,insurance_premium:e.value.insurance_premium,administrative_fees_percentage:e.value.administrative_fees_percentage,taf:e.value.taf,tax_fee_interest_rate:e.value.tax_fee_interest_rate,guarantees:e.value.guarantees}});let c="/pv";if(u.value=A(),n.status==201)e.value.guarantees.forEach(m=>{m.type_of_guarantee_id==9&&(c="/pv/without-notification")}),k.push(c);else for(const m in n.errors)n.errors[m].forEach(V=>{u.value[m]+=V+`
`});Y(()=>{var m;(m=g.value)==null||m.resetValidation()})}})},O=t=>{e.value.guarantees.splice(t,1)},z=()=>{e.value.guarantees.push({type_of_guarantee_id:1,expiration_date:"",value:"",comment:""})};return(t,l)=>{const n=re,c=le,m=ae,V=ee;return q(),b("div",null,[se,a(oe,{ref_key:"refForm",ref:g,onSubmit:J(B,["prevent"])},{default:i(()=>[a(I,null,{default:i(()=>[a(s,{md:"12"},{default:i(()=>[a(S,{class:"mb-6",title:"Information du pv"},{default:i(()=>[a(j,null,{default:i(()=>[a(I,null,{default:i(()=>[a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.committee_id,"onUpdate:modelValue":l[0]||(l[0]=r=>e.value.committee_id=r),"error-messages":u.value.committee_id,label:"Numéro du comitée",placeholder:"Ex: CFNTG-044-13-12-23-01212",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(c,{modelValue:e.value.committee_date,"onUpdate:modelValue":l[1]||(l[1]=r=>e.value.committee_date=r),"error-messages":u.value.committee_date,label:"Date du comitée",placeholder:"Ex: 2024-12-12",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(m,{modelValue:e.value.caf_id,"onUpdate:modelValue":l[2]||(l[2]=r=>e.value.caf_id=r),items:o(G),"error-messages":u.value.caf_id,label:"Chargé d'affaire",placeholder:"Ex: DJANTE Komla","item-title":"full_name","item-value":"id",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","items","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(V,{modelValue:e.value.civility,"onUpdate:modelValue":l[3]||(l[3]=r=>e.value.civility=r),items:D,"error-messages":u.value.civility,label:"Civilité",placeholder:"Ex: Mr",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.applicant_first_name,"onUpdate:modelValue":l[4]||(l[4]=r=>e.value.applicant_first_name=r),"error-messages":u.value.applicant_first_name,label:"Prénom du demandeur",placeholder:"Ex: Cesar",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.applicant_last_name,"onUpdate:modelValue":l[5]||(l[5]=r=>e.value.applicant_last_name=r),"error-messages":u.value.applicant_last_name,label:"Nom du demandeur",placeholder:"Ex: Endure",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.account_number,"onUpdate:modelValue":l[6]||(l[6]=r=>e.value.account_number=r),"error-messages":u.value.account_number,label:"Numéro de compte",placeholder:"Ex: 251012345678",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.activity,"onUpdate:modelValue":l[7]||(l[7]=r=>e.value.activity=r),"error-messages":u.value.activity,label:"Activé",placeholder:"Ex: Homme d'affaire",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.purpose_of_financing,"onUpdate:modelValue":l[8]||(l[8]=r=>e.value.purpose_of_financing=r),"error-messages":u.value.purpose_of_financing,label:"Objet du financement",placeholder:"Ex: Achat nouveau locaux",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(m,{modelValue:e.value.type_of_credit_id,"onUpdate:modelValue":l[9]||(l[9]=r=>e.value.type_of_credit_id=r),items:o($),"error-messages":u.value.type_of_credit_id,label:"Type de credit",placeholder:"Ex: Avance sur salaire","item-title":"full_name","item-value":"id",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","items","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.amount,"onUpdate:modelValue":l[10]||(l[10]=r=>e.value.amount=r),type:"number","error-messages":u.value.amount,label:"Montant",placeholder:"Ex: 15 000 000",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.duration,"onUpdate:modelValue":l[11]||(l[11]=r=>e.value.duration=r),type:"number","error-messages":u.value.duration,label:"Durée du crédit en mois",placeholder:"Ex: 18","append-inner-icon":"tabler-calendar",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(V,{modelValue:e.value.periodicity,"onUpdate:modelValue":l[12]||(l[12]=r=>e.value.periodicity=r),items:P,"error-messages":u.value.periodicity,label:"Periodicité",placeholder:"Ex: Mensuelle",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.due_amount,"onUpdate:modelValue":l[13]||(l[13]=r=>e.value.due_amount=r),type:"number","error-messages":u.value.due_amount,label:"Montant d'une échéance",placeholder:"Ex: 150 000",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[a(n,{modelValue:e.value.insurance_premium,"onUpdate:modelValue":l[14]||(l[14]=r=>e.value.insurance_premium=r),type:"number","error-messages":u.value.insurance_premium,label:"Prime d'assurance",placeholder:"Ex: 25000",rules:["requiredValidator"in t?t.requiredValidator:o(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12"},{default:i(()=>[a(U,{modelValue:e.value.taf,"onUpdate:modelValue":l[16]||(l[16]=r=>e.value.taf=r),label:"TAF(%)","error-messages":u.value.taf,"thumb-size":15,"thumb-label":"always",rules:["requiredValidator"in t?t.requiredValidator:o(d)],step:"0.1"},{append:i(()=>[a(w,{modelValue:e.value.taf,"onUpdate:modelValue":l[15]||(l[15]=r=>e.value.taf=r),"error-messages":u.value.taf,type:"number",style:{width:"80px"},density:"compact","hide-details":"",variant:"outlined",suffix:"%"},null,8,["modelValue","error-messages"])]),_:1},8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12"},{default:i(()=>[a(U,{modelValue:e.value.administrative_fees_percentage,"onUpdate:modelValue":l[18]||(l[18]=r=>e.value.administrative_fees_percentage=r),label:"Frais de dossier(%)","error-messages":u.value.administrative_fees_percentage,"thumb-size":15,"thumb-label":"always",rules:["requiredValidator"in t?t.requiredValidator:o(d)],step:"0.1"},{append:i(()=>[a(w,{modelValue:e.value.administrative_fees_percentage,"onUpdate:modelValue":l[17]||(l[17]=r=>e.value.administrative_fees_percentage=r),"error-messages":u.value.administrative_fees_percentage,type:"number",style:{width:"80px"},density:"compact","hide-details":"",variant:"outlined",suffix:"%"},null,8,["modelValue","error-messages"])]),_:1},8,["modelValue","error-messages","rules"])]),_:1}),a(s,{cols:"12"},{default:i(()=>[a(U,{modelValue:e.value.tax_fee_interest_rate,"onUpdate:modelValue":l[20]||(l[20]=r=>e.value.tax_fee_interest_rate=r),label:"Taux d'intérêt HT(%)","error-messages":u.value.tax_fee_interest_rate,"thumb-size":15,"thumb-label":"always",rules:["requiredValidator"in t?t.requiredValidator:o(d)],step:"0.1"},{append:i(()=>[a(w,{modelValue:e.value.tax_fee_interest_rate,"onUpdate:modelValue":l[19]||(l[19]=r=>e.value.tax_fee_interest_rate=r),"error-messages":u.value.tax_fee_interest_rate,type:"number",style:{width:"80px"},density:"compact","hide-details":"",variant:"outlined",suffix:"%"},null,8,["modelValue","error-messages"])]),_:1},8,["modelValue","error-messages","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),a(S,{class:"mb-6",title:"Information des cautionies"},{default:i(()=>[a(j,{class:"add-products-form"},{default:i(()=>[(q(!0),b(Z,null,Q(e.value.guarantees,(r,H)=>(q(),b("div",de,[a(te,{id:H,data:r,onRemoveGuarantee:O},null,8,["id","data"])]))),256)),_("div",ne,[a(x,{"prepend-icon":"tabler-plus",onClick:z},{default:i(()=>[E(" Ajouter ")]),_:1})])]),_:1})]),_:1})]),_:1}),a(s,{cols:"12"},{default:i(()=>[_("div",me,[pe,_("div",_e,[a(x,{type:"reset",variant:"tonal",color:"primary"},{default:i(()=>[a(M,{start:"",icon:"tabler-circle-minus"}),E(" Effacer ")]),_:1}),a(x,{type:"submit",class:"me-3"},{default:i(()=>[E(" Enregistrer "),a(M,{end:"",icon:"tabler-checkbox"})]),_:1})])])]),_:1})]),_:1})]),_:1},512)])}}},ze=ue(fe,[["__scopeId","data-v-b7139163"]]);export{ze as default};
