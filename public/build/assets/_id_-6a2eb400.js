import{r as d}from"./validators-be8c4c00.js";import{ah as x,a1 as $,r as V,c as T,b as r,e as i,s as e,$ as X,F as S,E as Y,n as ee,o as q,a2 as ae,a3 as v,M as f,f as re,x as D,N as le,A as te,d as E,Z as L,ai as ie}from"./main-35f434e5.js";import{_ as oe}from"./AppSelect-f486f450.js";import{_ as se}from"./AppAutocomplete-6c363bb0.js";import{_ as ue}from"./AppDateTimePicker-cb72b21d.js";import{_ as de}from"./AppTextField-4144e217.js";import{_ as ne}from"./GuaranteeEdit-8e6f5002.js";import{u as A}from"./useApi-f6bf8dd7.js";import{c as M}from"./createUrl-376a4625.js";import{$ as me}from"./api-bc7c6e86.js";import{V as g}from"./VRow-5bf9819c.js";import{V as pe}from"./VSnackbar-9ea4b62f.js";import{V as s}from"./VCol-bbc947c1.js";import{V as fe}from"./VForm-b1b04516.js";import{V as R}from"./VCard-de226d5c.js";import{V as j}from"./VCardText-2ef94eba.js";import{V as _e}from"./VAlert-0517fb9d.js";import{V as k}from"./VSlider-96233bbb.js";import{V as C}from"./VTextField-31ac9b36.js";import"./VSelect-8eaa7a4a.js";import"./forwardRefs-6ea3df5c.js";import"./VList-a84ed864.js";import"./VImg-fb08db81.js";import"./VAvatar-5cd70722.js";import"./VDivider-2199d20e.js";import"./VOverlay-6080deb7.js";import"./VMenu-ad7875d9.js";import"./filter-e1345ab9.js";import"./AppTextarea-fc7a54f9.js";import"./index-9c720871.js";import"./useAbility-597cc743.js";const ce={class:"my-4 ma-sm-4"},Ve={class:"mt-4 ma-sm-4"},ve={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},ge=E("div",{class:"d-flex flex-column justify-center"},null,-1),ye={class:"d-flex gap-4 align-center flex-wrap"},Xe={__name:"[id]",async setup(be){let m,_;const I=Y(),w=ee();let y="/pv";const P=[{value:"Mr",title:"Mr"},{value:"Mme",title:"Mme"},{value:"Mlle",title:"Mlle"}],B=[{value:"mensual",title:"Mensuelle"},{value:"quarterly",title:"Trimestrielle"},{value:"semi-annual",title:"Semestrielle"},{value:"annual",title:"Annuelle"},{value:"in-fine",title:"A la fin"}],{data:G}=([m,_]=x(()=>A(M("/type-of-credit",{query:{paginate:0}}))),m=await m,_(),m),z=$(()=>G.value.data),{data:O}=([m,_]=x(()=>A(M("/user",{query:{paginate:0,profile:"caf"}}))),m=await m,_(),m),H=$(()=>O.value.data),h=()=>({committee_id:"",committee_date:"",caf_id:"",civility:"",applicant_first_name:"",applicant_last_name:"",account_number:"",activity:"",purpose_of_financing:"",type_of_credit_id:"",amount:"",duration:"",periodicity:"",due_amount:"",insurance_premium:"",administrative_fees_percentage:"",taf:"",tax_fee_interest_rate:""}),u=V(h()),{data:J}=([m,_]=x(()=>A(M(`/verbal-trial/${w.params.id}`,{query:{with_caf:1,with_type_of_credit:1,with_guarantees:1}}))),m=await m,_(),m);var a=V(J.value.data.verbalTrial);const F=V(),K=()=>{var o;(o=F.value)==null||o.validate().then(async({valid:l})=>{if(l){const n=await me(`/verbal-trial/${w.params.id}`,{method:"PUT",body:{committee_id:a.value.committee_id,committee_date:a.value.committee_date,caf_id:a.value.caf_id,civility:a.value.civility,applicant_first_name:a.value.applicant_first_name,applicant_last_name:a.value.applicant_last_name,account_number:a.value.account_number,activity:a.value.activity,purpose_of_financing:a.value.purpose_of_financing,type_of_credit_id:a.value.type_of_credit_id,amount:a.value.amount,duration:a.value.duration,periodicity:a.value.periodicity,due_amount:a.value.due_amount,insurance_premium:a.value.insurance_premium,administrative_fees_percentage:a.value.administrative_fees_percentage,taf:a.value.taf,tax_fee_interest_rate:a.value.tax_fee_interest_rate,guarantees:a.value.guarantees}});if(u.value=h(),n.status==200)a.value.guarantees.forEach(p=>{p.type_of_guarantee_id==9&&(y="/pv/without-notification")}),I.push(y);else if(n.status==403){b.value=!0,U.value="";for(const p in n.errors)n.errors[p].forEach(c=>{U.value+=c+`
`})}else for(const p in n.errors)n.errors[p].forEach(c=>{u.value[p]+=c+`
`});ie(()=>{})}})},Z=o=>{a.value.guarantees.splice(o,1)},Q=()=>{a.value.guarantees.push({type_of_guarantee_id:1,expiration_date:"",value:"",comment:""})};a.value.guarantees.forEach(o=>{o.type_of_guarantee_id==9&&(y="/pv/without-notification")});const b=V(!1),U=V("");return(o,l)=>{const n=de,p=ue,c=se,N=oe;return q(),T(S,null,[r(g,null,{default:i(()=>[r(s,{cols:"12",md:"12"},{default:i(()=>[r(fe,{ref_key:"refForm",ref:F,onSubmit:ae(K,["prevent"])},{default:i(()=>[r(g,null,{default:i(()=>[r(s,{cols:"11"},{default:i(()=>[r(v,{"prepend-icon":"tabler-arrow-narrow-left",to:e(y)},{default:i(()=>[f(" Procès verbaux ")]),_:1},8,["to"])]),_:1}),r(s,{cols:"1",class:"text-right"},{default:i(()=>[r(v,{"append-icon":"tabler-eye",to:{name:"pv-id",params:{id:e(w).params.id}}},{default:i(()=>[f(" Voir ")]),_:1},8,["to"])]),_:1})]),_:1}),r(g,null,{default:i(()=>[r(s,{md:"12"},{default:i(()=>[r(R,{class:"mb-6",title:"Modification du pv de comité"},{default:i(()=>[r(j,null,{default:i(()=>[r(g,null,{default:i(()=>[r(s,null,{default:i(()=>[e(a).status=="rejected"&&e(a).status_observation?(q(),re(_e,{key:0,color:"warning"},{default:i(()=>[f(" Motif du refus : "+D(e(a).status_observation),1)]),_:1})):le("",!0)]),_:1})]),_:1}),r(g,null,{default:i(()=>[r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).committee_id,"onUpdate:modelValue":l[0]||(l[0]=t=>e(a).committee_id=t),"error-messages":e(u).committee_id,label:"Numéro du comitée",placeholder:"Ex: CFNTG-044-13-12-23-01212",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(p,{modelValue:e(a).committee_date,"onUpdate:modelValue":l[1]||(l[1]=t=>e(a).committee_date=t),"error-messages":e(u).committee_date,label:"Date du comitée",placeholder:"Ex: 2024-12-12",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(c,{modelValue:e(a).caf_id,"onUpdate:modelValue":l[2]||(l[2]=t=>e(a).caf_id=t),items:e(H),"error-messages":e(u).caf_id,label:"Chargé d'affaire",placeholder:"Ex: DJANTE Komla","item-title":"full_name","item-value":"id",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","items","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(N,{modelValue:e(a).civility,"onUpdate:modelValue":l[3]||(l[3]=t=>e(a).civility=t),items:P,"error-messages":e(u).civility,label:"Civilité",placeholder:"Ex: Mr",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).applicant_first_name,"onUpdate:modelValue":l[4]||(l[4]=t=>e(a).applicant_first_name=t),"error-messages":e(u).applicant_first_name,label:"Prénom du demandeur",placeholder:"Ex: Cesar",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).applicant_last_name,"onUpdate:modelValue":l[5]||(l[5]=t=>e(a).applicant_last_name=t),"error-messages":e(u).applicant_last_name,label:"Nom du demandeur",placeholder:"Ex: Endure",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).account_number,"onUpdate:modelValue":l[6]||(l[6]=t=>e(a).account_number=t),"error-messages":e(u).account_number,label:"Numéro de compte",placeholder:"Ex: 251012345678",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).activity,"onUpdate:modelValue":l[7]||(l[7]=t=>e(a).activity=t),"error-messages":e(u).activity,label:"Activé",placeholder:"Ex: Homme d'affaire",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).purpose_of_financing,"onUpdate:modelValue":l[8]||(l[8]=t=>e(a).purpose_of_financing=t),"error-messages":e(u).purpose_of_financing,label:"Objet du financement",placeholder:"Ex: Achat nouveau locaux",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(c,{modelValue:e(a).type_of_credit_id,"onUpdate:modelValue":l[9]||(l[9]=t=>e(a).type_of_credit_id=t),items:e(z),"error-messages":e(u).type_of_credit_id,label:"Type de credit",placeholder:"Ex: Avance sur salaire","item-title":"name","item-value":"id",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","items","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).amount,"onUpdate:modelValue":l[10]||(l[10]=t=>e(a).amount=t),type:"number","error-messages":e(u).amount,label:"Montant",placeholder:"Ex: 15 000 000",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).duration,"onUpdate:modelValue":l[11]||(l[11]=t=>e(a).duration=t),type:"number","error-messages":e(u).duration,label:"Durée du crédit en mois",placeholder:"Ex: 18","append-inner-icon":"tabler-calendar",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(N,{modelValue:e(a).periodicity,"onUpdate:modelValue":l[12]||(l[12]=t=>e(a).periodicity=t),items:B,"error-messages":e(u).periodicity,label:"Periodicité",placeholder:"Ex: Mensuelle",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"6",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).due_amount,"onUpdate:modelValue":l[13]||(l[13]=t=>e(a).due_amount=t),type:"number","error-messages":e(u).due_amount,label:"Montant d'une échéance",placeholder:"Ex: 150 000",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12",md:"12",lg:"4"},{default:i(()=>[r(n,{modelValue:e(a).insurance_premium,"onUpdate:modelValue":l[14]||(l[14]=t=>e(a).insurance_premium=t),type:"number","error-messages":e(u).insurance_premium,label:"Prime d'assurance",placeholder:"Ex: 25000",rules:["requiredValidator"in o?o.requiredValidator:e(d)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12"},{default:i(()=>[r(k,{modelValue:e(a).taf,"onUpdate:modelValue":l[16]||(l[16]=t=>e(a).taf=t),label:"TAF(%)","error-messages":e(u).taf,"thumb-size":15,"thumb-label":"always",rules:["requiredValidator"in o?o.requiredValidator:e(d)],step:"0.1"},{append:i(()=>[r(C,{modelValue:e(a).taf,"onUpdate:modelValue":l[15]||(l[15]=t=>e(a).taf=t),"error-messages":e(u).taf,type:"number",style:{width:"80px"},density:"compact","hide-details":"",variant:"outlined",suffix:"%"},null,8,["modelValue","error-messages"])]),_:1},8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12"},{default:i(()=>[r(k,{modelValue:e(a).administrative_fees_percentage,"onUpdate:modelValue":l[18]||(l[18]=t=>e(a).administrative_fees_percentage=t),label:"Frais de dossier(%)","error-messages":e(u).administrative_fees_percentage,"thumb-size":15,"thumb-label":"always",rules:["requiredValidator"in o?o.requiredValidator:e(d)],step:"0.1"},{append:i(()=>[r(C,{modelValue:e(a).administrative_fees_percentage,"onUpdate:modelValue":l[17]||(l[17]=t=>e(a).administrative_fees_percentage=t),"error-messages":e(u).administrative_fees_percentage,type:"number",style:{width:"80px"},density:"compact","hide-details":"",variant:"outlined",suffix:"%"},null,8,["modelValue","error-messages"])]),_:1},8,["modelValue","error-messages","rules"])]),_:1}),r(s,{cols:"12"},{default:i(()=>[r(k,{modelValue:e(a).tax_fee_interest_rate,"onUpdate:modelValue":l[20]||(l[20]=t=>e(a).tax_fee_interest_rate=t),label:"Taux d'intérêt HT(%)","error-messages":e(u).tax_fee_interest_rate,"thumb-size":15,"thumb-label":"always",rules:["requiredValidator"in o?o.requiredValidator:e(d)],step:"0.1"},{append:i(()=>[r(C,{modelValue:e(a).tax_fee_interest_rate,"onUpdate:modelValue":l[19]||(l[19]=t=>e(a).tax_fee_interest_rate=t),"error-messages":e(u).tax_fee_interest_rate,type:"number",style:{width:"80px"},density:"compact","hide-details":"",variant:"outlined",suffix:"%"},null,8,["modelValue","error-messages"])]),_:1},8,["modelValue","error-messages","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),r(R,{class:"mb-6",title:"Information des cautionies"},{default:i(()=>[r(j,{class:"add-products-form"},{default:i(()=>[(q(!0),T(S,null,te(e(a).guarantees,(t,W)=>(q(),T("div",ce,[r(ne,{id:W,data:t,onRemoveGuarantee:Z},null,8,["id","data"])]))),256)),E("div",Ve,[r(v,{"prepend-icon":"tabler-plus",onClick:Q},{default:i(()=>[f(" Ajouter ")]),_:1})])]),_:1})]),_:1})]),_:1}),r(s,{cols:"12"},{default:i(()=>[E("div",ve,[ge,E("div",ye,[r(v,{type:"reset",variant:"tonal",color:"primary"},{default:i(()=>[r(L,{start:"",icon:"tabler-circle-minus"}),f(" Effacer ")]),_:1}),r(v,{type:"submit",class:"me-3"},{default:i(()=>[f(" Enregistrer "),r(L,{end:"",icon:"tabler-checkbox"})]),_:1})])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),r(pe,{modelValue:e(b),"onUpdate:modelValue":l[21]||(l[21]=t=>X(b)?b.value=t:null),transition:"scroll-y-reverse-transition",location:"bottom end",color:"error"},{default:i(()=>[f(D(e(U)),1)]),_:1},8,["modelValue"])],64)}}};export{Xe as default};
