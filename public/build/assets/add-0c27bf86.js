import{r as q,ai as M,E as z,aa as A,w as E,o as i,f as _,e as n,b as l,M as u,a2 as F,s as t,N as d,c as r,d as b,F as R,A as G,a3 as c,Z as y}from"./main-50481d5f.js";import{a as $}from"./axios-1779699b.js";import{V as I}from"./VRow-a81a1884.js";import{V as g,b as x}from"./VCard-335757d8.js";import{V as S}from"./VCardText-89aa1fdf.js";import{V as j}from"./VForm-e4fa45ac.js";import{V}from"./VSelect-5e04043b.js";import{V as s}from"./VTextField-9e4adc87.js";import{V as D}from"./VCol-8d7d8655.js";import"./VAvatar-ecc6d3c8.js";import"./VImg-5716300f.js";import"./forwardRefs-6ea3df5c.js";import"./VList-16614a3d.js";import"./VDivider-4bb27e6e.js";import"./VOverlay-4bfe0313.js";import"./VMenu-83eb56ac.js";const L={key:1,class:"d-flex gap-2 mb-2"},P={key:2,class:"mb-2"},W={class:"d-flex gap-2 mb-2"},Z={key:4,class:"mb-4"},H={class:"d-flex gap-2"},re={__name:"add",setup(J){const e=q({last_name:"",first_name:"",email:"",phone:"",account_number:"",date_de_creation_compte:"",montant_endettement:"",type_attestation:"",type:"",gages:[]}),k=M.useToast(),U=z(),C=["personne physique","personne morale"],T=["main levée de gage","cloture","endettement","non endettement"],h=["Monsieur","Madame"],w=A("userToken"),f=()=>{e.value.gages.push({marque:"",immatriculation:""})},B=m=>{e.value.gages.splice(m,1)};E(()=>e.value.type_attestation,m=>{m==="main levée de gage"?e.value.gages.length===0&&f():e.value.gages=[]});const N=async()=>{try{await $.post("/api/attestation",{last_name:e.value.last_name,first_name:e.value.first_name,civilite:e.value.civilite,raison_sociale:e.value.raison_sociale,email:e.value.email,phone:e.value.phone,account_number:e.value.account_number,date_de_creation_compte:e.value.date_de_creation_compte,type:e.value.type,type_attestation:e.value.type_attestation,montant_endettement:e.value.montant_endettement,gages:e.value.gages},{headers:{Authorization:`Bearer ${w.value}`}}).then(m=>{if(m.status==200){let o=k.success("Attestation créée!!",{position:"top-right"});U.push("/attestation"),e.value={last_name:"",first_name:"",civilite:"",raison_sociale:"",email:"",phone:"",account_number:"",date_de_creation_compte:"",type:"",type_attestation:"",montant_endettement:"",gages:[]}}})}catch(m){console.log(m)}};return(m,o)=>(i(),_(I,null,{default:n(()=>[l(D,{cols:"12"},{default:n(()=>[l(g,null,{default:n(()=>[l(x,null,{default:n(()=>[u("Nouvelle attestation")]),_:1}),l(S,null,{default:n(()=>[l(j,{onSubmit:F(N,["prevent"])},{default:n(()=>[l(V,{class:"z-index-1000 mb-2",label:"Type",modelValue:t(e).type,"onUpdate:modelValue":o[0]||(o[0]=a=>t(e).type=a),items:C},null,8,["modelValue"]),l(V,{class:"z-index-40 mb-2",label:"Type d'attestation",modelValue:t(e).type_attestation,"onUpdate:modelValue":o[1]||(o[1]=a=>t(e).type_attestation=a),items:T},null,8,["modelValue"]),t(e).type=="personne physique"?(i(),_(V,{key:0,class:"z-index-40 mb-2",label:"Civilité",modelValue:t(e).civilite,"onUpdate:modelValue":o[2]||(o[2]=a=>t(e).civilite=a),items:h},null,8,["modelValue"])):d("",!0),t(e).type=="personne physique"?(i(),r("div",L,[l(s,{label:"Nom",modelValue:t(e).last_name,"onUpdate:modelValue":o[3]||(o[3]=a=>t(e).last_name=a)},null,8,["modelValue"]),l(s,{label:"Prénom",modelValue:t(e).first_name,"onUpdate:modelValue":o[4]||(o[4]=a=>t(e).first_name=a)},null,8,["modelValue"])])):d("",!0),t(e).type=="personne morale"?(i(),r("div",P,[l(s,{label:"Raison sociale",modelValue:t(e).raison_sociale,"onUpdate:modelValue":o[5]||(o[5]=a=>t(e).raison_sociale=a)},null,8,["modelValue"])])):d("",!0),b("div",W,[l(s,{label:"Email",modelValue:t(e).email,"onUpdate:modelValue":o[6]||(o[6]=a=>t(e).email=a)},null,8,["modelValue"]),l(s,{label:"Téléphone",modelValue:t(e).phone,"onUpdate:modelValue":o[7]||(o[7]=a=>t(e).phone=a)},null,8,["modelValue"])]),l(s,{label:"Numéro de compte",class:"mb-2",modelValue:t(e).account_number,"onUpdate:modelValue":o[8]||(o[8]=a=>t(e).account_number=a)},null,8,["modelValue"]),t(e).type_attestation=="endettement"?(i(),_(s,{key:3,label:"Montant d'endettement",class:"mb-2",modelValue:t(e).montant_endettement,"onUpdate:modelValue":o[9]||(o[9]=a=>t(e).montant_endettement=a)},null,8,["modelValue"])):d("",!0),t(e).type_attestation==="main levée de gage"?(i(),r("div",Z,[l(g,{variant:"outlined",class:"pa-4"},{default:n(()=>[l(x,{class:"text-h6 mb-3"},{default:n(()=>[u("Gages")]),_:1}),(i(!0),r(R,null,G(t(e).gages,(a,v)=>(i(),r("div",{key:v,class:"d-flex gap-2 mb-3 align-center"},[l(s,{label:"Marque",modelValue:a.marque,"onUpdate:modelValue":p=>a.marque=p,class:"flex-grow-1",placeholder:"Ex: Toyota, BMW, etc."},null,8,["modelValue","onUpdate:modelValue"]),l(s,{label:"Immatriculation",modelValue:a.immatriculation,"onUpdate:modelValue":p=>a.immatriculation=p,class:"flex-grow-1",placeholder:"Ex: 1234ABC"},null,8,["modelValue","onUpdate:modelValue"]),l(c,{icon:"",color:"error",variant:"outlined",onClick:p=>B(v),disabled:t(e).gages.length===1,class:"ml-2"},{default:n(()=>[l(y,null,{default:n(()=>[u("mdi-delete")]),_:1})]),_:2},1032,["onClick","disabled"])]))),128)),l(c,{color:"primary",variant:"outlined",onClick:f,class:"mt-2"},{default:n(()=>[l(y,{class:"mr-2"},{default:n(()=>[u("mdi-plus")]),_:1}),u(" Ajouter un gage ")]),_:1})]),_:1})])):d("",!0),l(s,{type:"date",class:"mb-2",label:"Date de création du compte",modelValue:t(e).date_de_creation_compte,"onUpdate:modelValue":o[10]||(o[10]=a=>t(e).date_de_creation_compte=a)},null,8,["modelValue"]),b("div",H,[l(c,{type:"submit",class:"z-index-1000 mb-2"},{default:n(()=>[u("Créer")]),_:1}),l(c,{type:"reset",class:"z-index-1000 mb-2"},{default:n(()=>[u("Réinitialiser")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{re as default};
