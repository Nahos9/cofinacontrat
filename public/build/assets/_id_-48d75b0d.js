import{r as u}from"./validators-be8c4c00.js";import{E as Q,n as W,r as g,ah as D,a1 as X,o as c,c as N,b as r,e as l,a2 as Y,a3 as y,Z as j,M as f,s as a,f as U,x as L,N as w,F as ee,A as ae,d as v,C as re,D as le,aj as se}from"./main-f1b08e28.js";import{_ as te}from"./AppDateTimePicker-ba3aa1c2.js";import{_ as oe}from"./AppSelect-7de5cc5a.js";import{_ as ie}from"./AppTextField-69a687db.js";import{_ as de}from"./AppAutocomplete-6b28f386.js";import{V as ne,_ as ue}from"./PledgeEdit-893839a0.js";import{u as $}from"./useApi-a3fc7afe.js";import{c as F}from"./createUrl-4bc7136b.js";import{$ as me}from"./api-685ff73f.js";import{_ as _e}from"./_plugin-vue_export-helper-c27b6911.js";import{V as pe}from"./VForm-1f059ba2.js";import{V as ve}from"./VSnackbar-56340a4b.js";import{V as b}from"./VRow-cfd5c28f.js";import{V as i}from"./VCol-785143ee.js";import{V as h}from"./VCard-3bc3303e.js";import{V as q}from"./VCardText-75d87fa3.js";import{V as ce}from"./VAlert-f6bd6958.js";import{V as fe}from"./VSlider-4d53dce8.js";import{V as be}from"./VTextField-f14477a0.js";import"./VSelect-64c654bc.js";import"./forwardRefs-6ea3df5c.js";import"./VList-1035e3ce.js";import"./VImg-b961b6d3.js";import"./VAvatar-449fc9b2.js";import"./VDivider-e33bebdc.js";import"./VOverlay-d3b76df3.js";import"./VMenu-aa75d60b.js";import"./filter-759bd2ab.js";import"./index-9c720871.js";import"./useAbility-259a9a97.js";const M=E=>(re("data-v-0785401a"),E=E(),le(),E),Ve=M(()=>v("div",{class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},[v("div",{class:"d-flex flex-column justify-center"},[v("h4",{class:"text-h4 font-weight-medium"}," Modification de contrat "),v("span",null,"Dashboard/Contrats/Modification")])],-1)),ge={class:"my-4 ma-sm-4"},ye={class:"mt-4 ma-sm-4"},he={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},qe=M(()=>v("div",{class:"d-flex flex-column justify-center"},null,-1)),Ee={class:"d-flex gap-4 align-center flex-wrap"},ke={__name:"[id]",async setup(E){let p,k;const R=Q(),C=W(),A=g(!1),T=g(""),S=g(),x=[{value:"company",title:"Société"},{value:"individual_business",title:"Entreprise Individuel"},{value:"particular",title:"Particulier"}],B={1:"Avec gage",0:"Sans gage"},O=[{value:"cni",title:"Carte d'identité nationale"},{value:"passport",title:"Passeport"},{value:"residence_certificate",title:"Certificat de résidence"},{value:"driving_licence",title:"Permis de conduire"}],I=()=>({verbal_trial_id:"",representative_birth_date:"",representative_birth_place:"",representative_nationality:"",representative_home_address:"",representative_phone_number:"",representative_type_of_identity_document:"",representative_number_of_identity_document:"",representative_date_of_issue_of_identity_document:"",risk_premium_percentage:"",total_amount_of_interest:"",number_of_due_dates:"",type:"",has_pledges:"",company_denomination:"",company_legal_status:"",company_head_office_address:"",company_rccm_number:"",company_phone_number:"",individual_business_denomination:"",individual_business_corporate_purpose:"",individual_business_head_office_address:"",individual_business_rccm_number:"",individual_business_phone_number:""}),{data:P}=([p,k]=D(()=>$(F("/verbal-trial",{query:{has_contract:0,paginate:0}}))),p=await p,k(),p),{data:J}=([p,k]=D(()=>$(F(`/contract/${C.params.id}`,{query:{with_verbal_trial:1,with_company:1,with_individual_business:1,with_pledges:1}}))),p=await p,k(),p),z=()=>{var o;(o=S.value)==null||o.validate().then(async({valid:s})=>{if(s){const m={verbal_trial_id:e.value.verbal_trial_id,representative_birth_date:e.value.representative_birth_date,representative_birth_place:e.value.representative_birth_place,representative_nationality:e.value.representative_nationality,representative_home_address:e.value.representative_home_address,representative_phone_number:e.value.representative_phone_number,representative_type_of_identity_document:e.value.representative_type_of_identity_document,representative_number_of_identity_document:e.value.representative_number_of_identity_document,representative_date_of_issue_of_identity_document:e.value.representative_date_of_issue_of_identity_document,risk_premium_percentage:e.value.risk_premium_percentage,total_amount_of_interest:e.value.total_amount_of_interest,number_of_due_dates:e.value.number_of_due_dates,type:e.value.type,has_pledges:e.value.has_pledges};e.value.type=="company"?(m.company_denomination=e.value.company.denomination,m.company_legal_status=e.value.company.legal_status,m.company_head_office_address=e.value.company.head_office_address,m.company_rccm_number=e.value.company.rccm_number,m.company_phone_number=e.value.company.phone_number):e.value.type=="individual_business"&&(m.individual_business_denomination=e.value.individual_business.denomination,m.individual_business_corporate_purpose=e.value.individual_business.corporate_purpose,m.individual_business_head_office_address=e.value.individual_business.head_office_address,m.individual_business_rccm_number=e.value.individual_business.rccm_number,m.individual_business_phone_number=e.value.individual_business.phone_number),e.value.has_pledges=="1"&&(m.pledges=e.value.pledges);const n=await me(`/contract/${C.params.id}`,{method:"PUT",body:m});if(d.value=I(),n.status==200)R.push("/contract");else if(n.status==403){A.value=!0,T.value="";for(const _ in n.errors)n.errors[_].forEach(V=>{T.value+=V+`
`})}else for(const _ in n.errors)n.errors[_].forEach(V=>{d.value[_]+=V+`
`});se(()=>{var _;(_=S.value)==null||_.resetValidation()})}})},G=o=>{e.value.pledges.splice(o,1)},Z=()=>{e.value.pledges.push({type:"vehicle",comment:""})},d=g(I()),H=X(()=>P.value.data);var e=g(J.value.data.contract);return P.value.data.push(JSON.parse(JSON.stringify(e.value.verbal_trial))),e.value.company==null&&(e.value.company={denomination:"",legal_status:"",head_office_address:"",rccm_number:"",phone_number:""}),e.value.individual_business==null&&(e.value.individual_business={denomination:"",corporate_purpose:"",head_office_address:"",rccm_number:"",phone_number:""}),(o,s)=>{const m=de,n=ie,_=oe,V=te;return c(),N("div",null,[Ve,r(pe,{ref_key:"refForm",ref:S,onSubmit:Y(z,["prevent"])},{default:l(()=>[r(b,null,{default:l(()=>[r(i,{cols:"11"},{default:l(()=>[r(y,{to:{name:"contract"}},{default:l(()=>[r(j,{icon:"tabler-arrow-left"}),f(" Contrats ")]),_:1})]),_:1}),r(i,{cols:"1"},{default:l(()=>[r(y,{"append-icon":"tabler-eye",to:{name:"contract-id",params:{id:a(C).params.id}}},{default:l(()=>[f(" Voir ")]),_:1},8,["to"])]),_:1})]),_:1}),r(b,null,{default:l(()=>[r(i,{md:"12"},{default:l(()=>[r(h,{class:"mb-6",title:"Information sur contrat"},{default:l(()=>[r(q,null,{default:l(()=>[r(b,null,{default:l(()=>[r(i,null,{default:l(()=>[a(e).status=="rejected"&&a(e).status_observation?(c(),U(ce,{key:0,color:"warning"},{default:l(()=>[f(" Motif du refus : "+L(a(e).status_observation),1)]),_:1})):w("",!0)]),_:1})]),_:1}),r(b,null,{default:l(()=>[r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(m,{modelValue:a(e).verbal_trial_id,"onUpdate:modelValue":s[0]||(s[0]=t=>a(e).verbal_trial_id=t),items:a(H),"error-messages":d.value.verbal_trial_id,label:"Procès verbal",placeholder:"Ex: CFNTG-044-13-12-23-01212",rules:["requiredValidator"in o?o.requiredValidator:a(u)],"item-title":"label","item-value":"id"},null,8,["modelValue","items","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).total_amount_of_interest,"onUpdate:modelValue":s[1]||(s[1]=t=>a(e).total_amount_of_interest=t),type:"number","error-messages":d.value.total_amount_of_interest,label:"Montant total des intérêts",placeholder:"Ex: 15 000 000",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).number_of_due_dates,"onUpdate:modelValue":s[2]||(s[2]=t=>a(e).number_of_due_dates=t),type:"number","error-messages":d.value.number_of_due_dates,label:"Nombre d'échéance",placeholder:"Ex: 18",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(_,{modelValue:a(e).type,"onUpdate:modelValue":s[3]||(s[3]=t=>a(e).type=t),items:x,"error-messages":d.value.type,label:"Type",placeholder:"Ex: Particulier",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"10"},{default:l(()=>[r(fe,{modelValue:a(e).risk_premium_percentage,"onUpdate:modelValue":s[5]||(s[5]=t=>a(e).risk_premium_percentage=t),label:"Prime de risque (en pourcentage) du demandeur","error-messages":d.value.risk_premium_percentage,"thumb-size":15,"thumb-label":"always",rules:["requiredValidator"in o?o.requiredValidator:a(u)],step:"0.1"},{append:l(()=>[r(be,{modelValue:a(e).risk_premium_percentage,"onUpdate:modelValue":s[4]||(s[4]=t=>a(e).risk_premium_percentage=t),"error-messages":d.value.risk_premium_percentage,type:"number",style:{width:"80px"},density:"compact","hide-details":"",variant:"outlined",suffix:"%"},null,8,["modelValue","error-messages"])]),_:1},8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"2"},{default:l(()=>[r(ne,{modelValue:a(e).has_pledges,"onUpdate:modelValue":s[6]||(s[6]=t=>a(e).has_pledges=t),"true-value":"1","false-value":"0",label:B[a(e).has_pledges],"error-messages":d.value.has_pledges,"true-icon":"tabler-check","false-icon":"tabler-circle-x",color:"success"},null,8,["modelValue","label","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),a(e).has_pledges=="1"?(c(),U(h,{key:0,class:"mb-6",title:"Informations sur les gages"},{default:l(()=>[r(q,{class:"add-products-form"},{default:l(()=>[(c(!0),N(ee,null,ae(a(e).pledges,(t,K)=>(c(),N("div",ge,[r(ue,{id:K,data:t,onRemovePledge:G},null,8,["id","data"])]))),256)),v("div",ye,[r(y,{"prepend-icon":"tabler-plus",onClick:Z},{default:l(()=>[f(" Ajouter ")]),_:1})])]),_:1})]),_:1})):w("",!0),r(h,{class:"mb-6",title:"Information sur le client"},{default:l(()=>[r(q,null,{default:l(()=>[r(b,null,{default:l(()=>[r(i,{cols:"12",md:"6",lg:"4"},{default:l(()=>[r(V,{modelValue:a(e).representative_birth_date,"onUpdate:modelValue":s[7]||(s[7]=t=>a(e).representative_birth_date=t),"error-messages":d.value.representative_birth_date,label:"Date de naissance",placeholder:"Ex: 2000-12-12",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"4"},{default:l(()=>[r(n,{modelValue:a(e).representative_birth_place,"onUpdate:modelValue":s[8]||(s[8]=t=>a(e).representative_birth_place=t),"error-messages":d.value.representative_birth_place,label:"Lieu de naissance",placeholder:"Ex: Lomé",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"4"},{default:l(()=>[r(n,{modelValue:a(e).representative_nationality,"onUpdate:modelValue":s[9]||(s[9]=t=>a(e).representative_nationality=t),"error-messages":d.value.representative_nationality,label:"Nationalité",placeholder:"Ex: Togolaise",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"4"},{default:l(()=>[r(n,{modelValue:a(e).representative_home_address,"onUpdate:modelValue":s[10]||(s[10]=t=>a(e).representative_home_address=t),"error-messages":d.value.representative_home_address,label:"Addresse du domicile",placeholder:"Ex: Adewi, Lomé",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"4"},{default:l(()=>[r(_,{modelValue:a(e).representative_type_of_identity_document,"onUpdate:modelValue":s[11]||(s[11]=t=>a(e).representative_type_of_identity_document=t),items:O,"error-messages":d.value.representative_type_of_identity_document,label:"Type de la pièce d'identité",placeholder:"Ex: Passeport",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"4"},{default:l(()=>[r(n,{modelValue:a(e).representative_number_of_identity_document,"onUpdate:modelValue":s[12]||(s[12]=t=>a(e).representative_number_of_identity_document=t),"error-messages":d.value.representative_number_of_identity_document,label:"Numéro de la pièce d'identité",placeholder:"Ex: 251012345678",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(V,{modelValue:a(e).representative_date_of_issue_of_identity_document,"onUpdate:modelValue":s[13]||(s[13]=t=>a(e).representative_date_of_issue_of_identity_document=t),"error-messages":d.value.representative_date_of_issue_of_identity_document,label:"Date de délivrance de la pièce d'identité",placeholder:"Ex: 2022-01-01",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).representative_phone_number,"onUpdate:modelValue":s[14]||(s[14]=t=>a(e).representative_phone_number=t),"error-messages":d.value.representative_phone_number,label:"Numéro de téléphone",placeholder:"Ex: +228 96 96 96 96",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),a(e).type=="company"?(c(),U(h,{key:1,class:"mb-6",title:"Information sur la société"},{default:l(()=>[r(q,null,{default:l(()=>[r(b,{cols:"12"},{default:l(()=>[r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).company.denomination,"onUpdate:modelValue":s[15]||(s[15]=t=>a(e).company.denomination=t),"error-messages":d.value.company_denomination,label:"Dénomination",placeholder:"Ex: Adjovidjo",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).company.legal_status,"onUpdate:modelValue":s[16]||(s[16]=t=>a(e).company.legal_status=t),"error-messages":d.value.company_legal_status,label:"Forme juridique",placeholder:"Ex: ",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).company.rccm_number,"onUpdate:modelValue":s[17]||(s[17]=t=>a(e).company.rccm_number=t),"error-messages":d.value.company_rccm_number,label:"Numero RCCM",placeholder:"Ex: RC-44E18",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).company.phone_number,"onUpdate:modelValue":s[18]||(s[18]=t=>a(e).company.phone_number=t),"error-messages":d.value.company_phone_number,label:"Telephone de la société",placeholder:"Ex: +228 96 96 96 96",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12"},{default:l(()=>[r(n,{modelValue:a(e).company.head_office_address,"onUpdate:modelValue":s[19]||(s[19]=t=>a(e).company.head_office_address=t),"error-messages":d.value.company_head_office_address,label:"Addresse du siège social",placeholder:"Ex: Lomé, Adewi",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1})]),_:1})]),_:1})):w("",!0),a(e).type=="individual_business"?(c(),U(h,{key:2,class:"mb-6",title:"Information sur l'entreprise individuele"},{default:l(()=>[r(q,null,{default:l(()=>[r(b,{cols:"12"},{default:l(()=>[r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).individual_business.denomination,"onUpdate:modelValue":s[20]||(s[20]=t=>a(e).individual_business.denomination=t),"error-messages":d.value.individual_business_denomination,label:"Dénomination",placeholder:"Ex: Agban",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).individual_business.head_office_address,"onUpdate:modelValue":s[21]||(s[21]=t=>a(e).individual_business.head_office_address=t),"error-messages":d.value.individual_business_head_office_address,label:"Addresse du siège social",placeholder:"Ex: Lomé, Adewi",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).individual_business.rccm_number,"onUpdate:modelValue":s[22]||(s[22]=t=>a(e).individual_business.rccm_number=t),"error-messages":d.value.individual_business_rccm_number,label:"Numero RCCM",placeholder:"Ex: RC-44E18",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:l(()=>[r(n,{modelValue:a(e).individual_business.phone_number,"onUpdate:modelValue":s[23]||(s[23]=t=>a(e).individual_business.phone_number=t),"error-messages":d.value.individual_business_phone_number,label:"Telephone de la société",placeholder:"Ex: +228 96 96 96 96",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12"},{default:l(()=>[r(n,{modelValue:a(e).individual_business.corporate_purpose,"onUpdate:modelValue":s[24]||(s[24]=t=>a(e).individual_business.corporate_purpose=t),"error-messages":d.value.individual_business_corporate_purpose,label:"Objet social",placeholder:"Ex: ",rules:["requiredValidator"in o?o.requiredValidator:a(u)]},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1}),r(i,{cols:"12"},{default:l(()=>[v("div",he,[qe,v("div",Ee,[r(y,{type:"reset",variant:"tonal",color:"primary"},{default:l(()=>[r(j,{start:"",icon:"tabler-circle-minus"}),f(" Effacer ")]),_:1}),r(y,{type:"submit",class:"me-3"},{default:l(()=>[f(" Enregistrer "),r(j,{end:"",icon:"tabler-checkbox"})]),_:1})])])]),_:1})]),_:1})]),_:1},512),r(ve,{modelValue:A.value,"onUpdate:modelValue":s[25]||(s[25]=t=>A.value=t),transition:"scroll-y-reverse-transition",location:"bottom end",color:"error"},{default:l(()=>[f(L(T.value),1)]),_:1},8,["modelValue"])])}}},ra=_e(ke,[["__scopeId","data-v-0785401a"]]);export{ra as default};
