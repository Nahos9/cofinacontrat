import{r as u}from"./validators-be8c4c00.js";import{n as R,E as j,r as g,ah as I,a1 as $,o as N,c as D,b as r,e as o,a2 as B,s as d,d as _,a3 as x,Z as E,M as A,C as F,D as G,aj as L}from"./main-b79bab7d.js";import{_ as M}from"./AppTextarea-aba9749f.js";import{_ as P}from"./AppSelect-c193feb1.js";import{_ as O}from"./AppDateTimePicker-e1c7c24e.js";import{_ as Z}from"./AppTextField-27ca1ff4.js";import{_ as z}from"./AppAutocomplete-840baa4d.js";import{u as H}from"./useApi-f36f0b4b.js";import{c as J}from"./createUrl-424af01a.js";import{$ as K}from"./api-0630d56b.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";import{V as W}from"./VForm-e3fe40fd.js";import{V as k}from"./VRow-aaddea0f.js";import{V as i}from"./VCol-54e0adfb.js";import{V as X}from"./VCard-ab8a42b0.js";import{V as Y}from"./VCardText-b8528b45.js";import"./VTextField-05b92c6c.js";import"./VImg-c7f49976.js";import"./forwardRefs-6ea3df5c.js";import"./VSelect-0570748a.js";import"./VList-4e005a62.js";import"./VAvatar-f2d16882.js";import"./VDivider-20e200a7.js";import"./VOverlay-b15ad492.js";import"./VMenu-b01cd03b.js";import"./filter-f4e45105.js";import"./index-9c720871.js";import"./useAbility-26157080.js";const w=c=>(F("data-v-930c0c72"),c=c(),G(),c),ee=w(()=>_("div",{class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},[_("div",{class:"d-flex flex-column justify-center"},[_("h4",{class:"text-h4 font-weight-medium"}," Ajouter un nouveau CAT ")])],-1)),re={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},te=w(()=>_("div",{class:"d-flex flex-column justify-center"},null,-1)),ae={class:"d-flex gap-4 align-center flex-wrap"},le={__name:"add",async setup(c){let p,b;const y=R(),T=j(),e=g({notification_id:null,credit_number:"978456123",sector:"So BAD",first_deadline:"2024-03-03",last_deadline:"2024-05-03",source_of_reimbursement:"revenue_from_the_activity",instructions_from_the_risk_and_credit_department:"Restriction sur le compte sous reserve du retrait du tableau d’amortissement et du contrat",outstanding_number_ready_to_settle:147896325,other_expenses:147896325,teg:147896325}),h=()=>({notification_id:"",credit_number:"",sector:"",first_deadline:"",last_deadline:"",source_of_reimbursement:"",instructions_from_the_risk_and_credit_department:"",outstanding_number_ready_to_settle:"",other_expenses:"",teg:""}),s=g(h()),{data:U}=([p,b]=I(()=>H(J("/notification",{query:{paginate:0,with_verbal_trial:1,has_cat:0,status:"v",is_simple:1}}))),p=await p,b(),p),q=$(()=>U.value.data),f=g(),C=()=>{var t;(t=f.value)==null||t.validate().then(async({valid:a})=>{if(a){const v={notification_id:e.value.notification_id,credit_number:e.value.credit_number,sector:e.value.sector,first_deadline:e.value.first_deadline,last_deadline:e.value.last_deadline,source_of_reimbursement:e.value.source_of_reimbursement,instructions_from_the_risk_and_credit_department:e.value.instructions_from_the_risk_and_credit_department,outstanding_number_ready_to_settle:e.value.outstanding_number_ready_to_settle,other_expenses:e.value.other_expenses,teg:e.value.teg},n=await K("/cat",{method:"POST",body:v});if(s.value=h(),n.status==201)T.push("/cat/simple-notification");else for(const m in n.errors)n.errors[m].forEach(V=>{s.value[m]+=V+`
`});L(()=>{var m;(m=f.value)==null||m.resetValidation()})}})};if(y.query.id){const t=parseInt(y.query.id);q.value.find(a=>a.id==t)&&(e.value.notification_id=t)}return(t,a)=>{const v=z,n=Z,m=O,V=P,S=M;return N(),D("div",null,[ee,r(W,{ref_key:"refForm",ref:f,onSubmit:B(C,["prevent"])},{default:o(()=>[r(k,null,{default:o(()=>[r(i,{md:"12"},{default:o(()=>[r(X,{class:"mb-6",title:"Information sur CAT"},{default:o(()=>[r(Y,null,{default:o(()=>[r(k,null,{default:o(()=>[r(i,{cols:"12",md:"12",lg:"12"},{default:o(()=>[r(v,{modelValue:e.value.notification_id,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.notification_id=l),items:d(q),"error-messages":s.value.notification_id,label:"Notification",placeholder:"Ex: CFNTG-044-13-12-23-01212",rules:["requiredValidator"in t?t.requiredValidator:d(u)],"item-title":"verbal_trial.label","item-value":"id"},null,8,["modelValue","items","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:o(()=>[r(n,{modelValue:e.value.credit_number,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.credit_number=l),"error-messages":s.value.credit_number,label:"Numéro du crédit",placeholder:"Ex: 485632",rules:["requiredValidator"in t?t.requiredValidator:d(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:o(()=>[r(n,{modelValue:e.value.sector,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.sector=l),"error-messages":s.value.sector,label:"Secteur",placeholder:"Ex: Agriculture",rules:["requiredValidator"in t?t.requiredValidator:d(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:o(()=>[r(m,{modelValue:e.value.first_deadline,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.first_deadline=l),"error-messages":s.value.first_deadline,label:"Date de première échéance",placeholder:"Ex: 2024-02-02",rules:["requiredValidator"in t?t.requiredValidator:d(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:o(()=>[r(m,{modelValue:e.value.last_deadline,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.last_deadline=l),"error-messages":s.value.last_deadline,label:"Date de dernière échéance",placeholder:"Ex: 2024-02-02",rules:["requiredValidator"in t?t.requiredValidator:d(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:o(()=>[r(V,{modelValue:e.value.source_of_reimbursement,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.source_of_reimbursement=l),items:[{value:"revenue_from_the_activity",title:"Recettes de l’activité"},{value:"final_payer_settlement",title:"Règlement du payeur final"},{value:"resale_of_goods",title:"Reventes des marchandises"}],"error-messages":s.value.source_of_reimbursement,label:"Source du remboursement",placeholder:"Ex: Recettes de l’activité",rules:["requiredValidator"in t?t.requiredValidator:d(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:o(()=>[r(n,{modelValue:e.value.outstanding_number_ready_to_settle,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.outstanding_number_ready_to_settle=l),"error-messages":s.value.outstanding_number_ready_to_settle,label:"Numéro encours prêt à solder",placeholder:"Ex: ",rules:["requiredValidator"in t?t.requiredValidator:d(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:o(()=>[r(n,{type:"number",modelValue:e.value.other_expenses,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.other_expenses=l),"error-messages":s.value.other_expenses,label:"Autres frais",placeholder:"Ex: ",rules:["requiredValidator"in t?t.requiredValidator:d(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"6",lg:"6"},{default:o(()=>[r(n,{type:"number",modelValue:e.value.teg,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.teg=l),"error-messages":s.value.teg,label:"TEG",placeholder:"Ex: 15000600",rules:["requiredValidator"in t?t.requiredValidator:d(u)]},null,8,["modelValue","error-messages","rules"])]),_:1}),r(i,{cols:"12",md:"12",lg:"12"},{default:o(()=>[r(S,{modelValue:e.value.instructions_from_the_risk_and_credit_department,"onUpdate:modelValue":a[9]||(a[9]=l=>e.value.instructions_from_the_risk_and_credit_department=l),"error-messages":s.value.instructions_from_the_risk_and_credit_department,label:"Instructions du département risque et crédit",placeholder:"Ex: ",rules:["requiredValidator"in t?t.requiredValidator:d(u)],clearable:"",counter:""},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),r(i,{cols:"12"},{default:o(()=>[_("div",re,[te,_("div",ae,[r(x,{type:"reset",variant:"tonal",color:"primary"},{default:o(()=>[r(E,{start:"",icon:"tabler-circle-minus"}),A(" Effacer ")]),_:1}),r(x,{type:"submit",class:"me-3"},{default:o(()=>[A(" Enregistrer "),r(E,{end:"",icon:"tabler-checkbox"})]),_:1})])])]),_:1})]),_:1})]),_:1},512)])}}},je=Q(le,[["__scopeId","data-v-930c0c72"]]);export{je as default};
